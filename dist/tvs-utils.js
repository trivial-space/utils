!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.tvsUtils=t():e.tvsUtils=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>M,vr:()=>U});var o={};e.r(o),e.d(o,{create:()=>D,update:()=>i,updatePosFromKeys:()=>P,updateRotFromMouse:()=>p});var r="undefined"!=typeof Float32Array?Float32Array:Array;function a(){var e=new r(16);return r!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function n(e,t,o){var r=t[0],a=t[1],n=t[2],A=t[3],E=t[4],T=t[5],s=t[6],F=t[7],I=t[8],D=t[9],i=t[10],P=t[11],p=t[12],U=t[13],M=t[14],N=t[15],d=o[0],C=o[1],f=o[2],u=o[3];return e[0]=d*r+C*E+f*I+u*p,e[1]=d*a+C*T+f*D+u*U,e[2]=d*n+C*s+f*i+u*M,e[3]=d*A+C*F+f*P+u*N,d=o[4],C=o[5],f=o[6],u=o[7],e[4]=d*r+C*E+f*I+u*p,e[5]=d*a+C*T+f*D+u*U,e[6]=d*n+C*s+f*i+u*M,e[7]=d*A+C*F+f*P+u*N,d=o[8],C=o[9],f=o[10],u=o[11],e[8]=d*r+C*E+f*I+u*p,e[9]=d*a+C*T+f*D+u*U,e[10]=d*n+C*s+f*i+u*M,e[11]=d*A+C*F+f*P+u*N,d=o[12],C=o[13],f=o[14],u=o[15],e[12]=d*r+C*E+f*I+u*p,e[13]=d*a+C*T+f*D+u*U,e[14]=d*n+C*s+f*i+u*M,e[15]=d*A+C*F+f*P+u*N,e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var A,E;function T(e,t,o){var a=new r(3);return a[0]=e,a[1]=t,a[2]=o,a}function s(e,t,o){return e[0]=t[0]+o[0],e[1]=t[1]+o[1],e[2]=t[2]+o[2],e}function F(e,t,o){return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}A=new r(3),r!=Float32Array&&(A[0]=0,A[1]=0,A[2]=0),function(e){e[e.CANCEL=3]="CANCEL",e[e.HELP=6]="HELP",e[e.BACK_SPACE=8]="BACK_SPACE",e[e.TAB=9]="TAB",e[e.CLEAR=12]="CLEAR",e[e.RETURN=13]="RETURN",e[e.ENTER=14]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CONTROL=17]="CONTROL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PRINTSCREEN=44]="PRINTSCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_1=49]="DIGIT_1",e[e.DIGIT_2=50]="DIGIT_2",e[e.DIGIT_3=51]="DIGIT_3",e[e.DIGIT_4=52]="DIGIT_4",e[e.DIGIT_5=53]="DIGIT_5",e[e.DIGIT_6=54]="DIGIT_6",e[e.DIGIT_7=55]="DIGIT_7",e[e.DIGIT_8=56]="DIGIT_8",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.EQUALS=61]="EQUALS",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUMPAD0=96]="NUMPAD0",e[e.NUMPAD1=97]="NUMPAD1",e[e.NUMPAD2=98]="NUMPAD2",e[e.NUMPAD3=99]="NUMPAD3",e[e.NUMPAD4=100]="NUMPAD4",e[e.NUMPAD5=101]="NUMPAD5",e[e.NUMPAD6=102]="NUMPAD6",e[e.NUMPAD7=103]="NUMPAD7",e[e.NUMPAD8=104]="NUMPAD8",e[e.NUMPAD9=105]="NUMPAD9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SEPARATOR=108]="SEPARATOR",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.F13=124]="F13",e[e.F14=125]="F14",e[e.F15=126]="F15",e[e.F16=127]="F16",e[e.F17=128]="F17",e[e.F18=129]="F18",e[e.F19=130]="F19",e[e.F20=131]="F20",e[e.F21=132]="F21",e[e.F22=133]="F22",e[e.F23=134]="F23",e[e.F24=135]="F24",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.BACK_QUOTE=192]="BACK_QUOTE",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.QUOTE=222]="QUOTE",e[e.META=224]="META"}(E||(E={}));const I={fovy:.6*Math.PI,aspect:window.innerWidth/window.innerHeight,near:.1,far:1e3,needsUpdatePerspective:!0,rotateX:0,rotateY:0,moveForward:0,moveLeft:0,moveUp:0,needsUpdateView:!1};function D(e={}){const t={props:Object.assign(Object.assign({},I),e),state:{view:a(),perspective:a(),rotationX:a(),rotationY:a(),position:[0,0,0]}};return i(t),t}function i({props:e,state:{view:t,perspective:o,rotationX:r,rotationY:a,position:A}}){e.needsUpdatePerspective&&(e.needsUpdatePerspective=!1,function(e,t,o,r,a){var n,A=1/Math.tan(t/2);e[0]=A/o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=A,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=a&&a!==1/0?(n=1/(r-a),e[10]=(a+r)*n,e[14]=2*a*r*n):(e[10]=-1,e[14]=-2*r)}(o,e.fovy,e.aspect,e.near,e.far));let E=e.needsUpdateView;if(e.rotateX&&(function(e,t,o){var r=Math.sin(o),a=Math.cos(o),n=t[4],A=t[5],E=t[6],T=t[7],s=t[8],F=t[9],I=t[10],D=t[11];t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*a+s*r,e[5]=A*a+F*r,e[6]=E*a+I*r,e[7]=T*a+D*r,e[8]=s*a-n*r,e[9]=F*a-A*r,e[10]=I*a-E*r,e[11]=D*a-T*r}(r,r,e.rotateX),e.rotateX=0,E=!0),e.rotateY&&(function(e,t,o){var r=Math.sin(o),a=Math.cos(o),n=t[0],A=t[1],E=t[2],T=t[3],s=t[8],F=t[9],I=t[10],D=t[11];t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*a-s*r,e[1]=A*a-F*r,e[2]=E*a-I*r,e[3]=T*a-D*r,e[8]=n*r+s*a,e[9]=A*r+F*a,e[10]=E*r+I*a,e[11]=T*r+D*a}(a,a,e.rotateY),e.rotateY=0,E=!0),e.moveForward){const t=T(a[8],a[9],a[10]);s(A,A,F(t,t,-e.moveForward)),e.moveForward=0,E=!0}if(e.moveLeft){const t=T(a[0],a[1],a[2]);s(A,A,F(t,t,-e.moveLeft)),e.moveLeft=0,E=!0}if(e.moveUp){const t=T(a[4],a[5],a[6]);s(A,A,F(t,t,e.moveUp)),e.moveUp=0,E=!0}return E&&(function(e,t){e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1}(t,A),n(t,t,a),n(t,t,r),function(e,t){var o=t[0],r=t[1],a=t[2],n=t[3],A=t[4],E=t[5],T=t[6],s=t[7],F=t[8],I=t[9],D=t[10],i=t[11],P=t[12],p=t[13],U=t[14],M=t[15],N=o*E-r*A,d=o*T-a*A,C=o*s-n*A,f=r*T-a*E,u=r*s-n*E,L=a*s-n*T,O=F*p-I*P,c=F*U-D*P,v=F*M-i*P,S=I*U-D*p,_=I*M-i*p,R=D*M-i*U,m=N*R-d*_+C*S+f*v-u*c+L*O;m&&(m=1/m,e[0]=(E*R-T*_+s*S)*m,e[1]=(a*_-r*R-n*S)*m,e[2]=(p*L-U*u+M*f)*m,e[3]=(D*u-I*L-i*f)*m,e[4]=(T*v-A*R-s*c)*m,e[5]=(o*R-a*v+n*c)*m,e[6]=(U*C-P*L-M*d)*m,e[7]=(F*L-D*C+i*d)*m,e[8]=(A*_-E*v+s*O)*m,e[9]=(r*v-o*_-n*O)*m,e[10]=(P*u-p*C+M*N)*m,e[11]=(I*C-F*u-i*N)*m,e[12]=(E*c-A*S-T*O)*m,e[13]=(o*S-r*c+a*O)*m,e[14]=(p*d-P*f-U*N)*m,e[15]=(F*f-I*d+D*N)*m)}(t,t),e.needsUpdateView=!1),E}function P(e,t,o){o&&((o[E.UP]||o[E.W])&&(e.props.moveForward=t),(o[E.DOWN]||o[E.S])&&(e.props.moveForward=-t),(o[E.LEFT]||o[E.A])&&(e.props.moveLeft=t),(o[E.RIGHT]||o[E.D])&&(e.props.moveLeft=-t))}function p(e,t,o){e.state.mouse=e.state.mouse||{x:0,y:0};const r=0===o.drag.x?o.drag.x:e.state.mouse.x-o.drag.x,a=0===o.drag.y?o.drag.y:e.state.mouse.y-o.drag.y;e.state.mouse.x=o.drag.x,e.state.mouse.y=o.drag.y,e.props.rotateX=a*t,e.props.rotateY=r*t}const U={camera:o},M={vr:U};return t})()));