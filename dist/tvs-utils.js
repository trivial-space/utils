!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.tvsLibs=r():t.tvsLibs=r()}(window,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,e),a.l=!0,a.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var a in t)e.d(n,a,function(r){return t[r]}.bind(null,a));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=1)}([function(module,__webpack_exports__,__webpack_require__){"use strict";function evaluate(code,context){var prefix="(function(){ return ",postfix="})",factory=eval(prefix+code+postfix);return factory.call(context)}__webpack_require__.d(__webpack_exports__,"a",function(){return evaluate})},function(t,r,e){"use strict";e.r(r);var n={};e.r(n),e.d(n,"create",function(){return d}),e.d(n,"clone",function(){return l}),e.d(n,"copy",function(){return T}),e.d(n,"fromValues",function(){return E}),e.d(n,"set",function(){return _}),e.d(n,"identity",function(){return A}),e.d(n,"transpose",function(){return h}),e.d(n,"invert",function(){return p}),e.d(n,"adjoint",function(){return M}),e.d(n,"determinant",function(){return m}),e.d(n,"multiply",function(){return v}),e.d(n,"translate",function(){return S}),e.d(n,"scale",function(){return y}),e.d(n,"rotate",function(){return R}),e.d(n,"rotateX",function(){return F}),e.d(n,"rotateY",function(){return N}),e.d(n,"rotateZ",function(){return b}),e.d(n,"fromTranslation",function(){return I}),e.d(n,"fromScaling",function(){return U}),e.d(n,"fromRotation",function(){return g}),e.d(n,"fromXRotation",function(){return D}),e.d(n,"fromYRotation",function(){return O}),e.d(n,"fromZRotation",function(){return L}),e.d(n,"fromRotationTranslation",function(){return P}),e.d(n,"fromQuat2",function(){return C}),e.d(n,"getTranslation",function(){return x}),e.d(n,"getScaling",function(){return w}),e.d(n,"getRotation",function(){return B}),e.d(n,"fromRotationTranslationScale",function(){return G}),e.d(n,"fromRotationTranslationScaleOrigin",function(){return z}),e.d(n,"fromQuat",function(){return H}),e.d(n,"frustum",function(){return X}),e.d(n,"perspective",function(){return V}),e.d(n,"perspectiveFromFieldOfView",function(){return Y}),e.d(n,"ortho",function(){return k}),e.d(n,"lookAt",function(){return W}),e.d(n,"targetTo",function(){return q}),e.d(n,"str",function(){return j}),e.d(n,"frob",function(){return K}),e.d(n,"add",function(){return Q}),e.d(n,"subtract",function(){return Z}),e.d(n,"multiplyScalar",function(){return J}),e.d(n,"multiplyScalarAndAdd",function(){return $}),e.d(n,"exactEquals",function(){return tt}),e.d(n,"equals",function(){return rt}),e.d(n,"mul",function(){return et}),e.d(n,"sub",function(){return nt});var a={};e.r(a),e.d(a,"create",function(){return at}),e.d(a,"clone",function(){return ut}),e.d(a,"length",function(){return it}),e.d(a,"fromValues",function(){return ot}),e.d(a,"copy",function(){return ft}),e.d(a,"set",function(){return ct}),e.d(a,"add",function(){return st}),e.d(a,"subtract",function(){return dt}),e.d(a,"multiply",function(){return lt}),e.d(a,"divide",function(){return Tt}),e.d(a,"ceil",function(){return Et}),e.d(a,"floor",function(){return _t}),e.d(a,"min",function(){return At}),e.d(a,"max",function(){return ht}),e.d(a,"round",function(){return pt}),e.d(a,"scale",function(){return Mt}),e.d(a,"scaleAndAdd",function(){return mt}),e.d(a,"distance",function(){return vt}),e.d(a,"squaredDistance",function(){return St}),e.d(a,"squaredLength",function(){return yt}),e.d(a,"negate",function(){return Rt}),e.d(a,"inverse",function(){return Ft}),e.d(a,"normalize",function(){return Nt}),e.d(a,"dot",function(){return bt}),e.d(a,"cross",function(){return It}),e.d(a,"lerp",function(){return Ut}),e.d(a,"hermite",function(){return gt}),e.d(a,"bezier",function(){return Dt}),e.d(a,"random",function(){return Ot}),e.d(a,"transformMat4",function(){return Lt}),e.d(a,"transformMat3",function(){return Pt}),e.d(a,"transformQuat",function(){return Ct}),e.d(a,"rotateX",function(){return xt}),e.d(a,"rotateY",function(){return wt}),e.d(a,"rotateZ",function(){return Bt}),e.d(a,"angle",function(){return Gt}),e.d(a,"str",function(){return zt}),e.d(a,"exactEquals",function(){return Ht}),e.d(a,"equals",function(){return Xt}),e.d(a,"sub",function(){return Vt}),e.d(a,"mul",function(){return Yt}),e.d(a,"div",function(){return kt}),e.d(a,"dist",function(){return Wt}),e.d(a,"sqrDist",function(){return qt}),e.d(a,"len",function(){return jt}),e.d(a,"sqrLen",function(){return Kt}),e.d(a,"forEach",function(){return Qt});var u={};e.r(u),e.d(u,"create",function(){return rr}),e.d(u,"update",function(){return er}),e.d(u,"updatePosFromKeys",function(){return nr}),e.d(u,"updateRotFromMouse",function(){return ir});var i={};e.r(i),e.d(i,"makePerspective",function(){return Fr}),e.d(i,"makeFirstPersonView",function(){return Nr});var o={};e.r(o),e.d(o,"createBodyCanvas",function(){return de}),e.d(o,"setupPainter",function(){return le}),e.d(o,"makeShadeEntity",function(){return Te}),e.d(o,"makeFormEntity",function(){return Ee}),e.d(o,"makeSketchEntity",function(){return _e}),e.d(o,"makeFlatSketchEntity",function(){return Ae}),e.d(o,"makeStaticLayerEntity",function(){return he}),e.d(o,"makeDrawingLayerEntity",function(){return pe}),e.d(o,"makeEffectLayerEntity",function(){return Me});const f=1e-6;let c="undefined"!=typeof Float32Array?Float32Array:Array;const s=Math.random;Math.PI;function d(){let t=new c(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l(t){let r=new c(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function T(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function E(t,r,e,n,a,u,i,o,f,s,d,l,T,E,_,A){let h=new c(16);return h[0]=t,h[1]=r,h[2]=e,h[3]=n,h[4]=a,h[5]=u,h[6]=i,h[7]=o,h[8]=f,h[9]=s,h[10]=d,h[11]=l,h[12]=T,h[13]=E,h[14]=_,h[15]=A,h}function _(t,r,e,n,a,u,i,o,f,c,s,d,l,T,E,_,A){return t[0]=r,t[1]=e,t[2]=n,t[3]=a,t[4]=u,t[5]=i,t[6]=o,t[7]=f,t[8]=c,t[9]=s,t[10]=d,t[11]=l,t[12]=T,t[13]=E,t[14]=_,t[15]=A,t}function A(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h(t,r){if(t===r){let e=r[1],n=r[2],a=r[3],u=r[6],i=r[7],o=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=u,t[11]=r[14],t[12]=a,t[13]=i,t[14]=o}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function p(t,r){let e=r[0],n=r[1],a=r[2],u=r[3],i=r[4],o=r[5],f=r[6],c=r[7],s=r[8],d=r[9],l=r[10],T=r[11],E=r[12],_=r[13],A=r[14],h=r[15],p=e*o-n*i,M=e*f-a*i,m=e*c-u*i,v=n*f-a*o,S=n*c-u*o,y=a*c-u*f,R=s*_-d*E,F=s*A-l*E,N=s*h-T*E,b=d*A-l*_,I=d*h-T*_,U=l*h-T*A,g=p*U-M*I+m*b+v*N-S*F+y*R;return g?(g=1/g,t[0]=(o*U-f*I+c*b)*g,t[1]=(a*I-n*U-u*b)*g,t[2]=(_*y-A*S+h*v)*g,t[3]=(l*S-d*y-T*v)*g,t[4]=(f*N-i*U-c*F)*g,t[5]=(e*U-a*N+u*F)*g,t[6]=(A*m-E*y-h*M)*g,t[7]=(s*y-l*m+T*M)*g,t[8]=(i*I-o*N+c*R)*g,t[9]=(n*N-e*I-u*R)*g,t[10]=(E*S-_*m+h*p)*g,t[11]=(d*m-s*S-T*p)*g,t[12]=(o*F-i*b-f*R)*g,t[13]=(e*b-n*F+a*R)*g,t[14]=(_*M-E*v-A*p)*g,t[15]=(s*v-d*M+l*p)*g,t):null}function M(t,r){let e=r[0],n=r[1],a=r[2],u=r[3],i=r[4],o=r[5],f=r[6],c=r[7],s=r[8],d=r[9],l=r[10],T=r[11],E=r[12],_=r[13],A=r[14],h=r[15];return t[0]=o*(l*h-T*A)-d*(f*h-c*A)+_*(f*T-c*l),t[1]=-(n*(l*h-T*A)-d*(a*h-u*A)+_*(a*T-u*l)),t[2]=n*(f*h-c*A)-o*(a*h-u*A)+_*(a*c-u*f),t[3]=-(n*(f*T-c*l)-o*(a*T-u*l)+d*(a*c-u*f)),t[4]=-(i*(l*h-T*A)-s*(f*h-c*A)+E*(f*T-c*l)),t[5]=e*(l*h-T*A)-s*(a*h-u*A)+E*(a*T-u*l),t[6]=-(e*(f*h-c*A)-i*(a*h-u*A)+E*(a*c-u*f)),t[7]=e*(f*T-c*l)-i*(a*T-u*l)+s*(a*c-u*f),t[8]=i*(d*h-T*_)-s*(o*h-c*_)+E*(o*T-c*d),t[9]=-(e*(d*h-T*_)-s*(n*h-u*_)+E*(n*T-u*d)),t[10]=e*(o*h-c*_)-i*(n*h-u*_)+E*(n*c-u*o),t[11]=-(e*(o*T-c*d)-i*(n*T-u*d)+s*(n*c-u*o)),t[12]=-(i*(d*A-l*_)-s*(o*A-f*_)+E*(o*l-f*d)),t[13]=e*(d*A-l*_)-s*(n*A-a*_)+E*(n*l-a*d),t[14]=-(e*(o*A-f*_)-i*(n*A-a*_)+E*(n*f-a*o)),t[15]=e*(o*l-f*d)-i*(n*l-a*d)+s*(n*f-a*o),t}function m(t){let r=t[0],e=t[1],n=t[2],a=t[3],u=t[4],i=t[5],o=t[6],f=t[7],c=t[8],s=t[9],d=t[10],l=t[11],T=t[12],E=t[13],_=t[14],A=t[15];return(r*i-e*u)*(d*A-l*_)-(r*o-n*u)*(s*A-l*E)+(r*f-a*u)*(s*_-d*E)+(e*o-n*i)*(c*A-l*T)-(e*f-a*i)*(c*_-d*T)+(n*f-a*o)*(c*E-s*T)}function v(t,r,e){let n=r[0],a=r[1],u=r[2],i=r[3],o=r[4],f=r[5],c=r[6],s=r[7],d=r[8],l=r[9],T=r[10],E=r[11],_=r[12],A=r[13],h=r[14],p=r[15],M=e[0],m=e[1],v=e[2],S=e[3];return t[0]=M*n+m*o+v*d+S*_,t[1]=M*a+m*f+v*l+S*A,t[2]=M*u+m*c+v*T+S*h,t[3]=M*i+m*s+v*E+S*p,M=e[4],m=e[5],v=e[6],S=e[7],t[4]=M*n+m*o+v*d+S*_,t[5]=M*a+m*f+v*l+S*A,t[6]=M*u+m*c+v*T+S*h,t[7]=M*i+m*s+v*E+S*p,M=e[8],m=e[9],v=e[10],S=e[11],t[8]=M*n+m*o+v*d+S*_,t[9]=M*a+m*f+v*l+S*A,t[10]=M*u+m*c+v*T+S*h,t[11]=M*i+m*s+v*E+S*p,M=e[12],m=e[13],v=e[14],S=e[15],t[12]=M*n+m*o+v*d+S*_,t[13]=M*a+m*f+v*l+S*A,t[14]=M*u+m*c+v*T+S*h,t[15]=M*i+m*s+v*E+S*p,t}function S(t,r,e){let n,a,u,i,o,f,c,s,d,l,T,E,_=e[0],A=e[1],h=e[2];return r===t?(t[12]=r[0]*_+r[4]*A+r[8]*h+r[12],t[13]=r[1]*_+r[5]*A+r[9]*h+r[13],t[14]=r[2]*_+r[6]*A+r[10]*h+r[14],t[15]=r[3]*_+r[7]*A+r[11]*h+r[15]):(n=r[0],a=r[1],u=r[2],i=r[3],o=r[4],f=r[5],c=r[6],s=r[7],d=r[8],l=r[9],T=r[10],E=r[11],t[0]=n,t[1]=a,t[2]=u,t[3]=i,t[4]=o,t[5]=f,t[6]=c,t[7]=s,t[8]=d,t[9]=l,t[10]=T,t[11]=E,t[12]=n*_+o*A+d*h+r[12],t[13]=a*_+f*A+l*h+r[13],t[14]=u*_+c*A+T*h+r[14],t[15]=i*_+s*A+E*h+r[15]),t}function y(t,r,e){let n=e[0],a=e[1],u=e[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=r[7]*a,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=r[11]*u,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function R(t,r,e,n){let a,u,i,o,c,s,d,l,T,E,_,A,h,p,M,m,v,S,y,R,F,N,b,I,U=n[0],g=n[1],D=n[2],O=Math.sqrt(U*U+g*g+D*D);return O<f?null:(U*=O=1/O,g*=O,D*=O,a=Math.sin(e),i=1-(u=Math.cos(e)),o=r[0],c=r[1],s=r[2],d=r[3],l=r[4],T=r[5],E=r[6],_=r[7],A=r[8],h=r[9],p=r[10],M=r[11],m=U*U*i+u,v=g*U*i+D*a,S=D*U*i-g*a,y=U*g*i-D*a,R=g*g*i+u,F=D*g*i+U*a,N=U*D*i+g*a,b=g*D*i-U*a,I=D*D*i+u,t[0]=o*m+l*v+A*S,t[1]=c*m+T*v+h*S,t[2]=s*m+E*v+p*S,t[3]=d*m+_*v+M*S,t[4]=o*y+l*R+A*F,t[5]=c*y+T*R+h*F,t[6]=s*y+E*R+p*F,t[7]=d*y+_*R+M*F,t[8]=o*N+l*b+A*I,t[9]=c*N+T*b+h*I,t[10]=s*N+E*b+p*I,t[11]=d*N+_*b+M*I,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)}function F(t,r,e){let n=Math.sin(e),a=Math.cos(e),u=r[4],i=r[5],o=r[6],f=r[7],c=r[8],s=r[9],d=r[10],l=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=u*a+c*n,t[5]=i*a+s*n,t[6]=o*a+d*n,t[7]=f*a+l*n,t[8]=c*a-u*n,t[9]=s*a-i*n,t[10]=d*a-o*n,t[11]=l*a-f*n,t}function N(t,r,e){let n=Math.sin(e),a=Math.cos(e),u=r[0],i=r[1],o=r[2],f=r[3],c=r[8],s=r[9],d=r[10],l=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=u*a-c*n,t[1]=i*a-s*n,t[2]=o*a-d*n,t[3]=f*a-l*n,t[8]=u*n+c*a,t[9]=i*n+s*a,t[10]=o*n+d*a,t[11]=f*n+l*a,t}function b(t,r,e){let n=Math.sin(e),a=Math.cos(e),u=r[0],i=r[1],o=r[2],f=r[3],c=r[4],s=r[5],d=r[6],l=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=u*a+c*n,t[1]=i*a+s*n,t[2]=o*a+d*n,t[3]=f*a+l*n,t[4]=c*a-u*n,t[5]=s*a-i*n,t[6]=d*a-o*n,t[7]=l*a-f*n,t}function I(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function U(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t,r,e){let n,a,u,i=e[0],o=e[1],c=e[2],s=Math.sqrt(i*i+o*o+c*c);return s<f?null:(i*=s=1/s,o*=s,c*=s,n=Math.sin(r),u=1-(a=Math.cos(r)),t[0]=i*i*u+a,t[1]=o*i*u+c*n,t[2]=c*i*u-o*n,t[3]=0,t[4]=i*o*u-c*n,t[5]=o*o*u+a,t[6]=c*o*u+i*n,t[7]=0,t[8]=i*c*u+o*n,t[9]=o*c*u-i*n,t[10]=c*c*u+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function D(t,r){let e=Math.sin(r),n=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function O(t,r){let e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function L(t,r){let e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function P(t,r,e){let n=r[0],a=r[1],u=r[2],i=r[3],o=n+n,f=a+a,c=u+u,s=n*o,d=n*f,l=n*c,T=a*f,E=a*c,_=u*c,A=i*o,h=i*f,p=i*c;return t[0]=1-(T+_),t[1]=d+p,t[2]=l-h,t[3]=0,t[4]=d-p,t[5]=1-(s+_),t[6]=E+A,t[7]=0,t[8]=l+h,t[9]=E-A,t[10]=1-(s+T),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function C(t,r){let e=new c(3),n=-r[0],a=-r[1],u=-r[2],i=r[3],o=r[4],f=r[5],s=r[6],d=r[7],l=n*n+a*a+u*u+i*i;return l>0?(e[0]=2*(o*i+d*n+f*u-s*a)/l,e[1]=2*(f*i+d*a+s*n-o*u)/l,e[2]=2*(s*i+d*u+o*a-f*n)/l):(e[0]=2*(o*i+d*n+f*u-s*a),e[1]=2*(f*i+d*a+s*n-o*u),e[2]=2*(s*i+d*u+o*a-f*n)),P(t,r,e),t}function x(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t}function w(t,r){let e=r[0],n=r[1],a=r[2],u=r[4],i=r[5],o=r[6],f=r[8],c=r[9],s=r[10];return t[0]=Math.sqrt(e*e+n*n+a*a),t[1]=Math.sqrt(u*u+i*i+o*o),t[2]=Math.sqrt(f*f+c*c+s*s),t}function B(t,r){let e=r[0]+r[5]+r[10],n=0;return e>0?(n=2*Math.sqrt(e+1),t[3]=.25*n,t[0]=(r[6]-r[9])/n,t[1]=(r[8]-r[2])/n,t[2]=(r[1]-r[4])/n):r[0]>r[5]&&r[0]>r[10]?(n=2*Math.sqrt(1+r[0]-r[5]-r[10]),t[3]=(r[6]-r[9])/n,t[0]=.25*n,t[1]=(r[1]+r[4])/n,t[2]=(r[8]+r[2])/n):r[5]>r[10]?(n=2*Math.sqrt(1+r[5]-r[0]-r[10]),t[3]=(r[8]-r[2])/n,t[0]=(r[1]+r[4])/n,t[1]=.25*n,t[2]=(r[6]+r[9])/n):(n=2*Math.sqrt(1+r[10]-r[0]-r[5]),t[3]=(r[1]-r[4])/n,t[0]=(r[8]+r[2])/n,t[1]=(r[6]+r[9])/n,t[2]=.25*n),t}function G(t,r,e,n){let a=r[0],u=r[1],i=r[2],o=r[3],f=a+a,c=u+u,s=i+i,d=a*f,l=a*c,T=a*s,E=u*c,_=u*s,A=i*s,h=o*f,p=o*c,M=o*s,m=n[0],v=n[1],S=n[2];return t[0]=(1-(E+A))*m,t[1]=(l+M)*m,t[2]=(T-p)*m,t[3]=0,t[4]=(l-M)*v,t[5]=(1-(d+A))*v,t[6]=(_+h)*v,t[7]=0,t[8]=(T+p)*S,t[9]=(_-h)*S,t[10]=(1-(d+E))*S,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function z(t,r,e,n,a){let u=r[0],i=r[1],o=r[2],f=r[3],c=u+u,s=i+i,d=o+o,l=u*c,T=u*s,E=u*d,_=i*s,A=i*d,h=o*d,p=f*c,M=f*s,m=f*d,v=n[0],S=n[1],y=n[2],R=a[0],F=a[1],N=a[2],b=(1-(_+h))*v,I=(T+m)*v,U=(E-M)*v,g=(T-m)*S,D=(1-(l+h))*S,O=(A+p)*S,L=(E+M)*y,P=(A-p)*y,C=(1-(l+_))*y;return t[0]=b,t[1]=I,t[2]=U,t[3]=0,t[4]=g,t[5]=D,t[6]=O,t[7]=0,t[8]=L,t[9]=P,t[10]=C,t[11]=0,t[12]=e[0]+R-(b*R+g*F+L*N),t[13]=e[1]+F-(I*R+D*F+P*N),t[14]=e[2]+N-(U*R+O*F+C*N),t[15]=1,t}function H(t,r){let e=r[0],n=r[1],a=r[2],u=r[3],i=e+e,o=n+n,f=a+a,c=e*i,s=n*i,d=n*o,l=a*i,T=a*o,E=a*f,_=u*i,A=u*o,h=u*f;return t[0]=1-d-E,t[1]=s+h,t[2]=l-A,t[3]=0,t[4]=s-h,t[5]=1-c-E,t[6]=T+_,t[7]=0,t[8]=l+A,t[9]=T-_,t[10]=1-c-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function X(t,r,e,n,a,u,i){let o=1/(e-r),f=1/(a-n),c=1/(u-i);return t[0]=2*u*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*u*f,t[6]=0,t[7]=0,t[8]=(e+r)*o,t[9]=(a+n)*f,t[10]=(i+u)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=i*u*2*c,t[15]=0,t}function V(t,r,e,n,a){let u=1/Math.tan(r/2),i=1/(n-a);return t[0]=u/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(a+n)*i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*a*n*i,t[15]=0,t}function Y(t,r,e,n){let a=Math.tan(r.upDegrees*Math.PI/180),u=Math.tan(r.downDegrees*Math.PI/180),i=Math.tan(r.leftDegrees*Math.PI/180),o=Math.tan(r.rightDegrees*Math.PI/180),f=2/(i+o),c=2/(a+u);return t[0]=f,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(i-o)*f*.5,t[9]=(a-u)*c*.5,t[10]=n/(e-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*e/(e-n),t[15]=0,t}function k(t,r,e,n,a,u,i){let o=1/(r-e),f=1/(n-a),c=1/(u-i);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*f,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(r+e)*o,t[13]=(a+n)*f,t[14]=(i+u)*c,t[15]=1,t}function W(t,r,e,n){let a,u,i,o,c,s,d,l,T,E,_=r[0],h=r[1],p=r[2],M=n[0],m=n[1],v=n[2],S=e[0],y=e[1],R=e[2];return Math.abs(_-S)<f&&Math.abs(h-y)<f&&Math.abs(p-R)<f?A(t):(d=_-S,l=h-y,T=p-R,a=m*(T*=E=1/Math.sqrt(d*d+l*l+T*T))-v*(l*=E),u=v*(d*=E)-M*T,i=M*l-m*d,(E=Math.sqrt(a*a+u*u+i*i))?(a*=E=1/E,u*=E,i*=E):(a=0,u=0,i=0),o=l*i-T*u,c=T*a-d*i,s=d*u-l*a,(E=Math.sqrt(o*o+c*c+s*s))?(o*=E=1/E,c*=E,s*=E):(o=0,c=0,s=0),t[0]=a,t[1]=o,t[2]=d,t[3]=0,t[4]=u,t[5]=c,t[6]=l,t[7]=0,t[8]=i,t[9]=s,t[10]=T,t[11]=0,t[12]=-(a*_+u*h+i*p),t[13]=-(o*_+c*h+s*p),t[14]=-(d*_+l*h+T*p),t[15]=1,t)}function q(t,r,e,n){let a=r[0],u=r[1],i=r[2],o=n[0],f=n[1],c=n[2],s=a-e[0],d=u-e[1],l=i-e[2],T=s*s+d*d+l*l;T>0&&(s*=T=1/Math.sqrt(T),d*=T,l*=T);let E=f*l-c*d,_=c*s-o*l,A=o*d-f*s;return(T=E*E+_*_+A*A)>0&&(E*=T=1/Math.sqrt(T),_*=T,A*=T),t[0]=E,t[1]=_,t[2]=A,t[3]=0,t[4]=d*A-l*_,t[5]=l*E-s*A,t[6]=s*_-d*E,t[7]=0,t[8]=s,t[9]=d,t[10]=l,t[11]=0,t[12]=a,t[13]=u,t[14]=i,t[15]=1,t}function j(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function K(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function Q(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t[6]=r[6]+e[6],t[7]=r[7]+e[7],t[8]=r[8]+e[8],t[9]=r[9]+e[9],t[10]=r[10]+e[10],t[11]=r[11]+e[11],t[12]=r[12]+e[12],t[13]=r[13]+e[13],t[14]=r[14]+e[14],t[15]=r[15]+e[15],t}function Z(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t[4]=r[4]-e[4],t[5]=r[5]-e[5],t[6]=r[6]-e[6],t[7]=r[7]-e[7],t[8]=r[8]-e[8],t[9]=r[9]-e[9],t[10]=r[10]-e[10],t[11]=r[11]-e[11],t[12]=r[12]-e[12],t[13]=r[13]-e[13],t[14]=r[14]-e[14],t[15]=r[15]-e[15],t}function J(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t[8]=r[8]*e,t[9]=r[9]*e,t[10]=r[10]*e,t[11]=r[11]*e,t[12]=r[12]*e,t[13]=r[13]*e,t[14]=r[14]*e,t[15]=r[15]*e,t}function $(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t[4]=r[4]+e[4]*n,t[5]=r[5]+e[5]*n,t[6]=r[6]+e[6]*n,t[7]=r[7]+e[7]*n,t[8]=r[8]+e[8]*n,t[9]=r[9]+e[9]*n,t[10]=r[10]+e[10]*n,t[11]=r[11]+e[11]*n,t[12]=r[12]+e[12]*n,t[13]=r[13]+e[13]*n,t[14]=r[14]+e[14]*n,t[15]=r[15]+e[15]*n,t}function tt(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]}function rt(t,r){let e=t[0],n=t[1],a=t[2],u=t[3],i=t[4],o=t[5],c=t[6],s=t[7],d=t[8],l=t[9],T=t[10],E=t[11],_=t[12],A=t[13],h=t[14],p=t[15],M=r[0],m=r[1],v=r[2],S=r[3],y=r[4],R=r[5],F=r[6],N=r[7],b=r[8],I=r[9],U=r[10],g=r[11],D=r[12],O=r[13],L=r[14],P=r[15];return Math.abs(e-M)<=f*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(n-m)<=f*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-v)<=f*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(u-S)<=f*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(i-y)<=f*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(o-R)<=f*Math.max(1,Math.abs(o),Math.abs(R))&&Math.abs(c-F)<=f*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(s-N)<=f*Math.max(1,Math.abs(s),Math.abs(N))&&Math.abs(d-b)<=f*Math.max(1,Math.abs(d),Math.abs(b))&&Math.abs(l-I)<=f*Math.max(1,Math.abs(l),Math.abs(I))&&Math.abs(T-U)<=f*Math.max(1,Math.abs(T),Math.abs(U))&&Math.abs(E-g)<=f*Math.max(1,Math.abs(E),Math.abs(g))&&Math.abs(_-D)<=f*Math.max(1,Math.abs(_),Math.abs(D))&&Math.abs(A-O)<=f*Math.max(1,Math.abs(A),Math.abs(O))&&Math.abs(h-L)<=f*Math.max(1,Math.abs(h),Math.abs(L))&&Math.abs(p-P)<=f*Math.max(1,Math.abs(p),Math.abs(P))}const et=v,nt=Z;function at(){let t=new c(3);return t[0]=0,t[1]=0,t[2]=0,t}function ut(t){var r=new c(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function it(t){let r=t[0],e=t[1],n=t[2];return Math.sqrt(r*r+e*e+n*n)}function ot(t,r,e){let n=new c(3);return n[0]=t,n[1]=r,n[2]=e,n}function ft(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function ct(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function st(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function dt(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function lt(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function Tt(t,r,e){return t[0]=r[0]/e[0],t[1]=r[1]/e[1],t[2]=r[2]/e[2],t}function Et(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t}function _t(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t}function At(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function ht(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function pt(t,r){return t[0]=Math.round(r[0]),t[1]=Math.round(r[1]),t[2]=Math.round(r[2]),t}function Mt(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function mt(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t}function vt(t,r){let e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2];return Math.sqrt(e*e+n*n+a*a)}function St(t,r){let e=r[0]-t[0],n=r[1]-t[1],a=r[2]-t[2];return e*e+n*n+a*a}function yt(t){let r=t[0],e=t[1],n=t[2];return r*r+e*e+n*n}function Rt(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t}function Ft(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t}function Nt(t,r){let e=r[0],n=r[1],a=r[2],u=e*e+n*n+a*a;return u>0&&(u=1/Math.sqrt(u),t[0]=r[0]*u,t[1]=r[1]*u,t[2]=r[2]*u),t}function bt(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function It(t,r,e){let n=r[0],a=r[1],u=r[2],i=e[0],o=e[1],f=e[2];return t[0]=a*f-u*o,t[1]=u*i-n*f,t[2]=n*o-a*i,t}function Ut(t,r,e,n){let a=r[0],u=r[1],i=r[2];return t[0]=a+n*(e[0]-a),t[1]=u+n*(e[1]-u),t[2]=i+n*(e[2]-i),t}function gt(t,r,e,n,a,u){let i=u*u,o=i*(2*u-3)+1,f=i*(u-2)+u,c=i*(u-1),s=i*(3-2*u);return t[0]=r[0]*o+e[0]*f+n[0]*c+a[0]*s,t[1]=r[1]*o+e[1]*f+n[1]*c+a[1]*s,t[2]=r[2]*o+e[2]*f+n[2]*c+a[2]*s,t}function Dt(t,r,e,n,a,u){let i=1-u,o=i*i,f=u*u,c=o*i,s=3*u*o,d=3*f*i,l=f*u;return t[0]=r[0]*c+e[0]*s+n[0]*d+a[0]*l,t[1]=r[1]*c+e[1]*s+n[1]*d+a[1]*l,t[2]=r[2]*c+e[2]*s+n[2]*d+a[2]*l,t}function Ot(t,r){r=r||1;let e=2*s()*Math.PI,n=2*s()-1,a=Math.sqrt(1-n*n)*r;return t[0]=Math.cos(e)*a,t[1]=Math.sin(e)*a,t[2]=n*r,t}function Lt(t,r,e){let n=r[0],a=r[1],u=r[2],i=e[3]*n+e[7]*a+e[11]*u+e[15];return i=i||1,t[0]=(e[0]*n+e[4]*a+e[8]*u+e[12])/i,t[1]=(e[1]*n+e[5]*a+e[9]*u+e[13])/i,t[2]=(e[2]*n+e[6]*a+e[10]*u+e[14])/i,t}function Pt(t,r,e){let n=r[0],a=r[1],u=r[2];return t[0]=n*e[0]+a*e[3]+u*e[6],t[1]=n*e[1]+a*e[4]+u*e[7],t[2]=n*e[2]+a*e[5]+u*e[8],t}function Ct(t,r,e){let n=e[0],a=e[1],u=e[2],i=e[3],o=r[0],f=r[1],c=r[2],s=a*c-u*f,d=u*o-n*c,l=n*f-a*o,T=a*l-u*d,E=u*s-n*l,_=n*d-a*s,A=2*i;return s*=A,d*=A,l*=A,T*=2,E*=2,_*=2,t[0]=o+s+T,t[1]=f+d+E,t[2]=c+l+_,t}function xt(t,r,e,n){let a=[],u=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],u[0]=a[0],u[1]=a[1]*Math.cos(n)-a[2]*Math.sin(n),u[2]=a[1]*Math.sin(n)+a[2]*Math.cos(n),t[0]=u[0]+e[0],t[1]=u[1]+e[1],t[2]=u[2]+e[2],t}function wt(t,r,e,n){let a=[],u=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],u[0]=a[2]*Math.sin(n)+a[0]*Math.cos(n),u[1]=a[1],u[2]=a[2]*Math.cos(n)-a[0]*Math.sin(n),t[0]=u[0]+e[0],t[1]=u[1]+e[1],t[2]=u[2]+e[2],t}function Bt(t,r,e,n){let a=[],u=[];return a[0]=r[0]-e[0],a[1]=r[1]-e[1],a[2]=r[2]-e[2],u[0]=a[0]*Math.cos(n)-a[1]*Math.sin(n),u[1]=a[0]*Math.sin(n)+a[1]*Math.cos(n),u[2]=a[2],t[0]=u[0]+e[0],t[1]=u[1]+e[1],t[2]=u[2]+e[2],t}function Gt(t,r){let e=ot(t[0],t[1],t[2]),n=ot(r[0],r[1],r[2]);Nt(e,e),Nt(n,n);let a=bt(e,n);return a>1?0:a<-1?Math.PI:Math.acos(a)}function zt(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ht(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function Xt(t,r){let e=t[0],n=t[1],a=t[2],u=r[0],i=r[1],o=r[2];return Math.abs(e-u)<=f*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(n-i)<=f*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(a-o)<=f*Math.max(1,Math.abs(a),Math.abs(o))}const Vt=dt,Yt=lt,kt=Tt,Wt=vt,qt=St,jt=it,Kt=yt,Qt=function(){let t=at();return function(r,e,n,a,u,i){let o,f;for(e||(e=3),n||(n=0),f=a?Math.min(a*e+n,r.length):r.length,o=n;o<f;o+=e)t[0]=r[o],t[1]=r[o+1],t[2]=r[o+2],u(t,t,i),r[o]=t[0],r[o+1]=t[1],r[o+2]=t[2];return r}}();!function(){let t=function(){let t=new c(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}()}();function Zt(){let t=new c(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Jt(t,r,e,n){let a,u,i,o,f,c=r[0],s=r[1],d=r[2],l=r[3],T=e[0],E=e[1],_=e[2],A=e[3];return(u=c*T+s*E+d*_+l*A)<0&&(u=-u,T=-T,E=-E,_=-_,A=-A),1-u>1e-6?(a=Math.acos(u),i=Math.sin(a),o=Math.sin((1-n)*a)/i,f=Math.sin(n*a)/i):(o=1-n,f=n),t[0]=o*c+f*T,t[1]=o*s+f*E,t[2]=o*d+f*_,t[3]=o*l+f*A,t}const $t=function(t,r){let e=r[0],n=r[1],a=r[2],u=r[3],i=e*e+n*n+a*a+u*u;return i>0&&(i=1/Math.sqrt(i),t[0]=e*i,t[1]=n*i,t[2]=a*i,t[3]=u*i),t};(function(){let t=at(),r=ot(1,0,0),e=ot(0,1,0)})(),function(){let t=Zt(),r=Zt()}(),function(){let t=function(){let t=new c(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}()}();!function(){let t=function(){let t=new c(2);return t[0]=0,t[1]=0,t}()}();var tr;function rr(t){void 0===t&&(t={});var r=Object.assign({fovy:.6*Math.PI,aspect:window.innerWidth/window.innerHeight,near:.1,far:1e3,needsUpdatePerspective:!1,rotateX:0,rotateY:0,moveForward:0,moveLeft:0,moveUp:0},t);return{props:r,state:{view:n.create(),perspective:n.perspective(n.create(),r.fovy,r.aspect,r.near,r.far),rotationX:n.create(),rotationY:n.create(),position:[0,0,0]}}}function er(t){var r=t.props,e=t.state,u=e.view,i=e.perspective,o=e.rotationX,f=e.rotationY,c=e.position;r.needsUpdatePerspective&&(r.needsUpdatePerspective=!1,n.perspective(i,r.fovy,r.aspect,r.near,r.far));var s=!1;if(r.rotateX&&(n.rotateX(o,o,r.rotateX),r.rotateX=0,s=!0),r.rotateY&&(n.rotateY(f,f,r.rotateY),r.rotateY=0,s=!0),r.moveForward){var d=a.fromValues(f[8],f[9],f[10]);a.add(c,c,a.scale(d,d,-r.moveForward)),r.moveForward=0,s=!0}if(r.moveLeft){d=a.fromValues(f[0],f[1],f[2]);a.add(c,c,a.scale(d,d,-r.moveLeft)),r.moveLeft=0,s=!0}if(r.moveUp){d=a.fromValues(f[4],f[5],f[6]);a.add(c,c,a.scale(d,d,r.moveUp)),r.moveUp=0,s=!0}s&&(n.fromTranslation(u,c),n.multiply(u,u,f),n.multiply(u,u,o),n.invert(u,u))}function nr(t,r,e){e&&((e[tr.UP]||e[tr.W])&&(t.props.moveForward=r),(e[tr.DOWN]||e[tr.S])&&(t.props.moveForward=-r),(e[tr.LEFT]||e[tr.A])&&(t.props.moveLeft=r),(e[tr.RIGHT]||e[tr.D])&&(t.props.moveLeft=-r))}!function(t){t[t.CANCEL=3]="CANCEL",t[t.HELP=6]="HELP",t[t.BACK_SPACE=8]="BACK_SPACE",t[t.TAB=9]="TAB",t[t.CLEAR=12]="CLEAR",t[t.RETURN=13]="RETURN",t[t.ENTER=14]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CONTROL=17]="CONTROL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESCAPE=27]="ESCAPE",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PRINTSCREEN=44]="PRINTSCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_1=49]="DIGIT_1",t[t.DIGIT_2=50]="DIGIT_2",t[t.DIGIT_3=51]="DIGIT_3",t[t.DIGIT_4=52]="DIGIT_4",t[t.DIGIT_5=53]="DIGIT_5",t[t.DIGIT_6=54]="DIGIT_6",t[t.DIGIT_7=55]="DIGIT_7",t[t.DIGIT_8=56]="DIGIT_8",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.EQUALS=61]="EQUALS",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUMPAD0=96]="NUMPAD0",t[t.NUMPAD1=97]="NUMPAD1",t[t.NUMPAD2=98]="NUMPAD2",t[t.NUMPAD3=99]="NUMPAD3",t[t.NUMPAD4=100]="NUMPAD4",t[t.NUMPAD5=101]="NUMPAD5",t[t.NUMPAD6=102]="NUMPAD6",t[t.NUMPAD7=103]="NUMPAD7",t[t.NUMPAD8=104]="NUMPAD8",t[t.NUMPAD9=105]="NUMPAD9",t[t.MULTIPLY=106]="MULTIPLY",t[t.ADD=107]="ADD",t[t.SEPARATOR=108]="SEPARATOR",t[t.SUBTRACT=109]="SUBTRACT",t[t.DECIMAL=110]="DECIMAL",t[t.DIVIDE=111]="DIVIDE",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.F13=124]="F13",t[t.F14=125]="F14",t[t.F15=126]="F15",t[t.F16=127]="F16",t[t.F17=128]="F17",t[t.F18=129]="F18",t[t.F19=130]="F19",t[t.F20=131]="F20",t[t.F21=132]="F21",t[t.F22=133]="F22",t[t.F23=134]="F23",t[t.F24=135]="F24",t[t.NUM_LOCK=144]="NUM_LOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.BACK_QUOTE=192]="BACK_QUOTE",t[t.OPEN_BRACKET=219]="OPEN_BRACKET",t[t.BACK_SLASH=220]="BACK_SLASH",t[t.CLOSE_BRACKET=221]="CLOSE_BRACKET",t[t.QUOTE=222]="QUOTE",t[t.META=224]="META"}(tr||(tr={}));var ar=0,ur=0;function ir(t,r,e){var n=0===e.drag.x?e.drag.x:ar-e.drag.x,a=0===e.drag.y?e.drag.y:ur-e.drag.y;ar=e.drag.x,ur=e.drag.y,t.props.rotateX=a*r,t.props.rotateY=n*r}Object.assign;var or=new Array(16);for(var fr=[],cr={},sr=0;sr<256;sr++)fr[sr]=(sr+256).toString(16).substr(1),cr[fr[sr]]=sr;function dr(){var t,r,e,n=function(){for(var t=0,r=void 0;t<16;t++)0==(3&t)&&(r=4294967296*Math.random(),or[t]=r>>>((3&t)<<3)&255);return or}();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,e=0,(r=fr)[(t=n)[e++]]+r[t[e++]]+r[t[e++]]+r[t[e++]]+"-"+r[t[e++]]+r[t[e++]]+"-"+r[t[e++]]+r[t[e++]]+"-"+r[t[e++]]+r[t[e++]]+"-"+r[t[e++]]+r[t[e++]]+r[t[e++]]+r[t[e++]]+r[t[e++]]+r[t[e++]]}var lr=e(0);function Tr(t){var r=t.id,e=t.entity,n=t.process,a=t.port,u=t.meta;if(null==e)throw TypeError("no entity specified in arc "+r);if(null==n)throw TypeError("no process specified in arc "+r);return null==r&&(r=null==a?n+"->"+e:e+"->"+n+"::"+a),{id:r,entity:e,process:n,port:a,meta:u}}var Er={COLD:"COLD",HOT:"HOT",ACCUMULATOR:"ACCUMULATOR"},_r=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},Ar="Stream",hr="Reaction";function pr(t,r){return r?r+"."+t:t}function Mr(t){var r,e,n,a=t.value,u=dr(),i=[],o={};return o.HOT={entity:o,type:Er.HOT},o.COLD={entity:o,type:Er.COLD},o.id=function(t,e){return u=pr(t,e),r=e,o},o.val=function(t){return a=t,o},o.updateVal=function(t){return a=t(a),o},o.accept=function(t){return e=t,o},o.reset=function(){return n=!0,o},o.getId=function(){return u},t.procedure&&i.push(t),o.react=function(t,r,e){var n=vr(t,r,e);n.pidSuffix=hr;var a=n.dependencies;return n.dependencies=[{entity:o,type:Er.ACCUMULATOR}],a&&a.length&&(n.dependencies=n.dependencies.concat(a)),i.push(n),o},o.getGraph=function(){var t={entities:{},processes:{},arcs:{},meta:{}};return t.entities[u]=function(t){var r=t.id,e=void 0===r?dr():r,n=t.value,a=t.json,u=t.accept,i=t.reset,o=t.meta;return void 0===n&&a&&(n=JSON.parse(a)),{id:e,value:n,accept:u,reset:i,meta:o}}({id:u,value:a,accept:e,reset:n}),i.forEach(function(e){var n=e.dependencies,a=e.processId?pr(e.processId,r):u+e.pidSuffix+(n&&n.length?":"+n.reduce(function(t,r){var e=r.entity.getId();return e===u?t:t+":"+e},""):""),i=[];n&&n.forEach(function(r,e){if(i[e]=r.type,r.type!==Er.ACCUMULATOR){var n=Tr({process:a,entity:r.entity.getId(),port:e});t.arcs[n.id]=n}});var o=Tr({process:a,entity:u});t.arcs[o.id]=o,t.processes[a]=function(t,r){var e=t.id,n=void 0===e?dr():e,a=t.ports,u=void 0===a?[]:a,i=t.procedure,o=t.code,f=t.autostart,c=void 0!==f&&f,s=t.async,d=void 0!==s&&s,l=t.delta,T=void 0!==l&&l,E=t.meta;if(null==i&&null!=o&&(i=Object(lr.a)(o,r)),null==i)throw TypeError("Process must have procedure or code set");return T&&!u.length&&u.push(Er.HOT),{id:n,ports:u,procedure:i,autostart:c,async:d,delta:T,meta:E}}({id:a,ports:i,procedure:e.procedure,async:e.async,autostart:e.autostart,delta:e.delta})}),t},o}function mr(t){return Mr({value:t})}function vr(t,r,e){var n={procedure:r};return null!=t&&t.length&&(n.dependencies=t),"string"==typeof e?n.processId=e:n.pidSuffix=Ar,n}var Sr=function(t,r,e){return Mr(vr(t,r,e))},yr=function(t,r,e){return Mr(_r({},vr(t,r,e),{async:!0}))},Rr=function(t,r,e){return Mr(_r({},vr(t,r,e),{async:!0,autostart:!0}))};function Fr(t){var r=mr({near:.1,far:1e3,fovy:.6*Math.PI,aspect:1}).react([t.HOT],function(t,r){var e=r.width,n=r.height;return t.aspect=e/n,t});return{perspectiveSettings:r,perspective:mr(n.create()).react([r.HOT],function(t,r){return n.perspective(t,r.fovy,r.aspect,r.near,r.far)})}}function Nr(){var t=mr(a.fromValues(0,0,0)),r=mr(0),e=mr(0),u=mr({rotX:n.create(),rotY:n.create()}).react([r.HOT],function(t,r){return n.fromYRotation(t.rotY,r),t}).react([e.HOT],function(t,r){return n.fromXRotation(t.rotX,r),t});return{position:t,rotation:u,view:mr(n.create()).react([u.HOT,t.HOT],function(t,r,e){return n.fromTranslation(t,e),n.multiply(t,t,r.rotY),n.multiply(t,t,r.rotX),n.invert(t,t),t}),rotY:r,rotX:e}}var br,Ir,Ur,gr={FLOAT:5126,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FLOAT_MAT2X3:35685,FLOAT_MAT2X4:35686,FLOAT_MAT3X2:35687,FLOAT_MAT3X4:35688,FLOAT_MAT4X2:35689,FLOAT_MAT4X3:35690,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT:5125,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,TEXTURE_2D:3553,TEXTURE_CUBE_MAP:34067,TEXTURE_3D:32879,TEXTURE_2D_ARRAY:35866,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,HALF_FLOAT:5131,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042};function Dr(t){return Gr[t].bindPoint}function Or(t,r){return function(e){t.uniform1i(r,e)}}function Lr(t,r){return function(e){t.uniform1iv(r,e)}}function Pr(t,r){return function(e){t.uniform2iv(r,e)}}function Cr(t,r){return function(e){t.uniform3iv(r,e)}}function xr(t,r){return function(e){t.uniform4iv(r,e)}}function wr(t,r,e,n){var a=Dr(r);return function(r){t.uniform1i(n,e),t.activeTexture(t.TEXTURE0+e),t.bindTexture(a,r)}}function Br(t,r,e,n,a){for(var u=Dr(r),i=new Int32Array(a),o=0;o<a;++o)i[o]=e+o;return function(r){for(var e in t.uniform1iv(n,i),r)t.activeTexture(t.TEXTURE0+i[e]),t.bindTexture(u,r[e])}}var Gr=((br={})[gr.FLOAT]={Type:Float32Array,size:4,setter:function(t,r){return function(e){t.uniform1f(r,e)}},arraySetter:function(t,r){return function(e){t.uniform1fv(r,e)}}},br[gr.FLOAT_VEC2]={Type:Float32Array,size:8,setter:function(t,r){return function(e){t.uniform2fv(r,e)}}},br[gr.FLOAT_VEC3]={Type:Float32Array,size:12,setter:function(t,r){return function(e){t.uniform3fv(r,e)}}},br[gr.FLOAT_VEC4]={Type:Float32Array,size:16,setter:function(t,r){return function(e){t.uniform4fv(r,e)}}},br[gr.INT]={Type:Int32Array,size:4,setter:Or,arraySetter:Lr},br[gr.INT_VEC2]={Type:Int32Array,size:8,setter:Pr},br[gr.INT_VEC3]={Type:Int32Array,size:12,setter:Cr},br[gr.INT_VEC4]={Type:Int32Array,size:16,setter:xr},br[gr.UNSIGNED_INT]={Type:Uint32Array,size:4,setter:function(t,r){return function(e){t.uniform1ui(r,e)}},arraySetter:function(t,r){return function(e){t.uniform1uiv(r,e)}}},br[gr.UNSIGNED_INT_VEC2]={Type:Uint32Array,size:8,setter:function(t,r){return function(e){t.uniform2uiv(r,e)}}},br[gr.UNSIGNED_INT_VEC3]={Type:Uint32Array,size:12,setter:function(t,r){return function(e){t.uniform3uiv(r,e)}}},br[gr.UNSIGNED_INT_VEC4]={Type:Uint32Array,size:16,setter:function(t,r){return function(e){t.uniform4uiv(r,e)}}},br[gr.BOOL]={Type:Uint32Array,size:4,setter:Or,arraySetter:Lr},br[gr.BOOL_VEC2]={Type:Uint32Array,size:8,setter:Pr},br[gr.BOOL_VEC3]={Type:Uint32Array,size:12,setter:Cr},br[gr.BOOL_VEC4]={Type:Uint32Array,size:16,setter:xr},br[gr.FLOAT_MAT2]={Type:Float32Array,size:16,setter:function(t,r){return function(e){t.uniformMatrix2fv(r,!1,e)}}},br[gr.FLOAT_MAT3]={Type:Float32Array,size:36,setter:function(t,r){return function(e){t.uniformMatrix3fv(r,!1,e)}}},br[gr.FLOAT_MAT4]={Type:Float32Array,size:64,setter:function(t,r){return function(e){t.uniformMatrix4fv(r,!1,e)}}},br[gr.FLOAT_MAT2X3]={Type:Float32Array,size:24,setter:function(t,r){return function(e){t.uniformMatrix2x3fv(r,!1,e)}}},br[gr.FLOAT_MAT2X4]={Type:Float32Array,size:32,setter:function(t,r){return function(e){t.uniformMatrix2x4fv(r,!1,e)}}},br[gr.FLOAT_MAT3X2]={Type:Float32Array,size:24,setter:function(t,r){return function(e){t.uniformMatrix3x2fv(r,!1,e)}}},br[gr.FLOAT_MAT3X4]={Type:Float32Array,size:48,setter:function(t,r){return function(e){t.uniformMatrix3x4fv(r,!1,e)}}},br[gr.FLOAT_MAT4X2]={Type:Float32Array,size:32,setter:function(t,r){return function(e){t.uniformMatrix4x2fv(r,!1,e)}}},br[gr.FLOAT_MAT4X3]={Type:Float32Array,size:48,setter:function(t,r){return function(e){t.uniformMatrix4x3fv(r,!1,e)}}},br[gr.SAMPLER_2D]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D},br[gr.SAMPLER_CUBE]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_CUBE_MAP},br[gr.SAMPLER_3D]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_3D},br[gr.SAMPLER_2D_SHADOW]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D},br[gr.SAMPLER_2D_ARRAY]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D_ARRAY},br[gr.SAMPLER_2D_ARRAY_SHADOW]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D_ARRAY},br[gr.SAMPLER_CUBE_SHADOW]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_CUBE_MAP},br[gr.INT_SAMPLER_2D]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D},br[gr.INT_SAMPLER_3D]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_3D},br[gr.INT_SAMPLER_CUBE]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_CUBE_MAP},br[gr.INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D_ARRAY},br[gr.UNSIGNED_INT_SAMPLER_2D]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D},br[gr.UNSIGNED_INT_SAMPLER_3D]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_3D},br[gr.UNSIGNED_INT_SAMPLER_CUBE]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_CUBE_MAP},br[gr.UNSIGNED_INT_SAMPLER_2D_ARRAY]={Type:null,size:0,setter:wr,arraySetter:Br,bindPoint:gr.TEXTURE_2D_ARRAY},br);function zr(t,r,e){return function(n){t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,e.itemSize,gr.FLOAT,n.normalize||!1,n.stride||0,n.offset||0)}}function Hr(t,r,e){return function(n){t.bindBuffer(t.ARRAY_BUFFER,n.buffer),t.enableVertexAttribArray(r),t.vertexAttribIPointer(r,e.itemSize,gr.INT,n.stride||0,n.offset||0)}}function Xr(t,r,e){var n=e.size,a=e.count;return function(e){t.bindBuffer(t.ARRAY_BUFFER,e.buffer);for(var u=n,i=u/a,o=Gr[gr.FLOAT].size*u,f=e.normalize||!1,c=e.offset||0,s=o/a,d=0;d<a;++d)t.enableVertexAttribArray(r+d),t.vertexAttribPointer(r+d,i,gr.FLOAT,f,o,c+s*d)}}var Vr=((Ir={})[gr.FLOAT]={size:4,setter:zr,itemSize:1},Ir[gr.FLOAT_VEC2]={size:8,setter:zr,itemSize:2},Ir[gr.FLOAT_VEC3]={size:12,setter:zr,itemSize:3},Ir[gr.FLOAT_VEC4]={size:16,setter:zr,itemSize:4},Ir[gr.INT]={size:4,setter:Hr,itemSize:1},Ir[gr.INT_VEC2]={size:8,setter:Hr,itemSize:2},Ir[gr.INT_VEC3]={size:12,setter:Hr,itemSize:3},Ir[gr.INT_VEC4]={size:16,setter:Hr,itemSize:4},Ir[gr.UNSIGNED_INT]={size:4,setter:Hr,itemSize:1},Ir[gr.UNSIGNED_INT_VEC2]={size:8,setter:Hr,itemSize:2},Ir[gr.UNSIGNED_INT_VEC3]={size:12,setter:Hr,itemSize:3},Ir[gr.UNSIGNED_INT_VEC4]={size:16,setter:Hr,itemSize:4},Ir[gr.BOOL]={size:4,setter:Hr,itemSize:1},Ir[gr.BOOL_VEC2]={size:8,setter:Hr,itemSize:2},Ir[gr.BOOL_VEC3]={size:12,setter:Hr,itemSize:3},Ir[gr.BOOL_VEC4]={size:16,setter:Hr,itemSize:4},Ir[gr.FLOAT_MAT2]={size:4,setter:Xr,count:2},Ir[gr.FLOAT_MAT3]={size:9,setter:Xr,count:3},Ir[gr.FLOAT_MAT4]={size:16,setter:Xr,count:4},Ir);var Yr;(Ur={})[gr.BYTE]=Int8Array,Ur[gr.UNSIGNED_BYTE]=Uint8Array,Ur[gr.SHORT]=Int16Array,Ur[gr.UNSIGNED_SHORT]=Uint16Array,Ur[gr.INT]=Int32Array,Ur[gr.UNSIGNED_INT]=Uint32Array,Ur[gr.FLOAT]=Float32Array,Ur[gr.UNSIGNED_SHORT_4_4_4_4]=Uint16Array,Ur[gr.UNSIGNED_SHORT_5_5_5_1]=Uint16Array,Ur[gr.UNSIGNED_SHORT_5_6_5]=Uint16Array,Ur[gr.HALF_FLOAT]=Uint16Array,Ur[gr.UNSIGNED_INT_2_10_10_10_REV]=Uint32Array,Ur[gr.UNSIGNED_INT_10F_11F_11F_REV]=Uint32Array,Ur[gr.UNSIGNED_INT_5_9_9_9_REV]=Uint32Array,Ur[gr.FLOAT_32_UNSIGNED_INT_24_8_REV]=Uint32Array,Ur[gr.UNSIGNED_INT_24_8]=Uint32Array;function kr(t,r,e){if(void 0===r&&(r={}),void 0===e&&(e={}),null!=r.flipY&&r.flipY!==e.flipY&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),r.wrap&&r.wrap!==e.wrap||r.wrapS&&r.wrapS!==e.wrapS||r.wrapT&&r.wrapT!==e.wrapT){var n=void 0,a=void 0;r.wrap?n=a=r.wrap:(a=r.wrapT||"CLAMP_TO_EDGE",n=r.wrapS||"CLAMP_TO_EDGE"),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[n]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[a])}r.magFilter&&r.magFilter!==e.magFilter&&t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[r.magFilter]),r.minFilter&&r.minFilter!==e.minFilter&&t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[r.minFilter])}function Wr(t,r,e,n){if(null!=r.width&&null!=r.height){null==r.frameBuffer&&(r.frameBuffer=t.createFramebuffer()),r.textures||(r.textures=[]),t.bindFramebuffer(t.FRAMEBUFFER,r.frameBuffer),r.textureConfig.type===t.FLOAT&&t.getExtension("OES_texture_float");var a=r.textureConfig.count;if(a>1){for(var u=t.getExtension("WEBGL_draw_buffers")||{drawBuffersWEBGL:function(){}},i=[],o=0;o<a;o++)i.push(u["COLOR_ATTACHMENT"+o+"_WEBGL"]);u.drawBuffersWEBGL(i);for(o=0;o<a;o++){null==r.textures[o]&&(r.textures[o]=t.createTexture());var f=r.textures[o];t.bindTexture(t.TEXTURE_2D,f),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,r.textureConfig.type,null),kr(t,e,n),t.framebufferTexture2D(t.FRAMEBUFFER,i[o],t.TEXTURE_2D,f,0)}}else{null==r.textures[0]&&(r.textures[0]=t.createTexture());f=r.textures[0];t.bindTexture(t.TEXTURE_2D,f),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r.width,r.height,0,t.RGBA,r.textureConfig.type,null),kr(t,e,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,f,0)}null==r.depthBuffer&&(r.depthBuffer=t.createRenderbuffer()),t.bindRenderbuffer(t.RENDERBUFFER,r.depthBuffer),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r.width,r.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,r.depthBuffer);var c=t.checkFramebufferStatus(t.FRAMEBUFFER);c!==t.FRAMEBUFFER_COMPLETE&&console.error("framebuffer error",c,e),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null)}}function qr(t,r){t.deleteFramebuffer(r.frameBuffer),t.deleteRenderbuffer(r.depthBuffer);for(var e=0,n=r.textures;e<n.length;e++){var a=n[e];t.deleteTexture(a)}}function jr(t,r){if(r.enable)for(var e=0,n=r.enable;e<n.length;e++){var a=n[e];t.enable(a)}if(r.disable)for(var u=0,i=r.disable;u<i.length;u++){a=i[u];t.disable(a)}r.blendFunc&&t.blendFunc.apply(t,r.blendFunc),null!=r.depthFunc&&t.depthFunc(r.depthFunc),null!=r.cullFace&&t.cullFace(r.cullFace),null!=r.frontFace&&t.frontFace(r.frontFace),null!=r.lineWidth&&t.lineWidth(r.lineWidth),r.colorMask&&t.colorMask.apply(t,r.colorMask),null!=r.depthMask&&t.depthMask(r.depthMask),r.clearColor&&t.clearColor.apply(t,r.clearColor),null!=r.clearDepth&&t.clearDepth(r.clearDepth),null!=r.clearBits&&t.clear(r.clearBits)}function Kr(t,r){if(r.enable)for(var e=0,n=r.enable;e<n.length;e++){var a=n[e];t.disable(a)}if(r.disable)for(var u=0,i=r.disable;u<i.length;u++){a=i[u];t.enable(a)}}function Qr(t){var r={};return r.update=function(e){e.drawType&&(r.drawType=t[e.drawType]),e.itemCount&&(r.itemCount=e.itemCount);var n=r.attribs||{};for(var a in e.attribs){var u=e.attribs[a];null==n[a]&&(n[a]={buffer:t.createBuffer()}),t.bindBuffer(t.ARRAY_BUFFER,n[a].buffer),t.bufferData(t.ARRAY_BUFFER,u.buffer,t[(u.storeType||"STATIC")+"_DRAW"])}if(r.attribs=n,e.elements){var i=e.elements.buffer;null==r.elements&&(r.elements={buffer:t.createBuffer(),glType:null}),r.elements.glType=function(t){if(t instanceof Int8Array)return gr.BYTE;if(t instanceof Uint8Array)return gr.UNSIGNED_BYTE;if(t instanceof Uint8ClampedArray)return gr.UNSIGNED_BYTE;if(t instanceof Int16Array)return gr.SHORT;if(t instanceof Uint16Array)return gr.UNSIGNED_SHORT;if(t instanceof Int32Array)return gr.INT;if(t instanceof Uint32Array)return gr.UNSIGNED_INT;if(t instanceof Float32Array)return gr.FLOAT;throw"unsupported typed array type"}(i),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.elements.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,i,t[(e.elements.storeType||"STATIC")+"_DRAW"])}return r},r.destroy=function(){for(var e in r.attribs)t.deleteBuffer(r.attribs[e].buffer);return r.elements&&t.deleteBuffer(r.elements.buffer),r},r}function Zr(t){var r={program:t.createProgram(),frag:t.createShader(t.FRAGMENT_SHADER),vert:t.createShader(t.VERTEX_SHADER)};return t.attachShader(r.program,r.vert),t.attachShader(r.program,r.frag),r.update=function(e){var n=e.frag&&e.frag.trim()||r.fragSource,a=e.vert&&e.vert.trim()||r.vertSource;if(!n||!a)return r;if(n.indexOf("GL_EXT_draw_buffers")>=0&&t.getExtension("WEBGL_draw_buffers"),t.shaderSource(r.vert,a),t.shaderSource(r.frag,n),t.compileShader(r.vert),t.compileShader(r.frag),t.getShaderParameter(r.vert,t.COMPILE_STATUS)||console.error("Error Compiling Vertex Shader!\n",t.getShaderInfoLog(r.vert),Jr(a)),t.getShaderParameter(r.frag,t.COMPILE_STATUS)||console.error("Error Compiling Fragment Shader!\n",t.getShaderInfoLog(r.frag),Jr(n)),t.linkProgram(r.program),!t.getProgramParameter(r.program,t.LINK_STATUS)){var u=t.getProgramInfoLog(r.program);console.error("Error in program linking:",u)}return r.uniformSetters=function(t,r){var e=0;function n(r,n){var a=t.getUniformLocation(r,n.name),u=n.size>1&&"[0]"===n.name.substr(-3),i=n.type,o=Gr[i];if(!o)throw"unknown type: 0x"+i.toString(16);if(null!=a){var f;if(null===o.Type){var c=e;e+=n.size,f=u?o.arraySetter(t,i,c,a,n.size):o.setter(t,i,c,a)}else f=o.arraySetter&&u?o.arraySetter(t,a):o.setter(t,a);return{setter:f,location:a}}}for(var a={},u=t.getProgramParameter(r,t.ACTIVE_UNIFORMS),i=0;i<u;++i){var o=t.getActiveUniform(r,i);if(!o)break;var f=o.name;if("[0]"===f.substr(-3)&&(f=f.substr(0,f.length-3)),r){var c=n(r,o);c&&(a[f]=c)}}return a}(t,r.program),r.attributeSetters=function(t,r){for(var e={},n=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),a=0;a<n;a++){var u=t.getActiveAttrib(r,a);if(!u)break;var i=t.getAttribLocation(r,u.name),o=Vr[u.type],f=o.setter(t,i,o);e[u.name]={setter:f,location:i}}return e}(t,r.program),r.fragSource=n,r.vertSource=a,r},r.destroy=function(){t.deleteProgram(r.program),t.deleteShader(r.frag),t.deleteShader(r.vert)},r}function Jr(t){return t.trim().split("\n").map(function(t,r){return r+1+": "+t}).join("\n")}function $r(){var t={update:function(r){return r.drawSettings&&(t.drawSettings=r.drawSettings),r.form&&(t.form=r.form),r.shade&&(t.shade=r.shade),r.uniforms&&(t.uniforms=r.uniforms),t},destroy:function(){t.form&&t.form.destroy(),t.shade&&t.shade.destroy()}};return t}function te(t){var r={textures:[],data:{},texture:function(t){return void 0===t&&(t=0),r.textures[t]},update:function(e){if(e.buffered&&!r.target?(r.target={width:e.width||t.canvas.width,height:e.height||t.canvas.height,frameBuffer:null,textures:[],depthBuffer:null,textureConfig:{type:e.textureConfig&&e.textureConfig.type||t.UNSIGNED_BYTE,count:e.textureConfig&&e.textureConfig.count||1}},Wr(t,r.target,e,r.data),r.textures=r.target.textures):r.target&&e.width&&e.height&&(r.target.width=e.width,r.target.height=e.height,Wr(t,r.target,e,r.data)),e.sketches&&(r.sketches=e.sketches),e.frag){var n=r.sketches&&r.sketches[0];n&&n.shade.update({frag:e.frag})}return e.uniforms&&(r.uniforms=e.uniforms),Object.assign(r.data,e),r},destroy:function(){if(r.sketches)for(var e=0,n=r.sketches;e<n.length;e++){n[e].destroy()}if(r.target)qr(t,r.target);else for(var a=0,u=r.textures;a<u.length;a++){var i=u[a];t.deleteTexture(i)}}};return r}function re(t){var r=t.getContext("webgl")||t.getContext("experimental-webgl");if(null==r)throw Error("Webgl context cannot be initialized");return r}var ee={wrap:"CLAMP_TO_EDGE",minFilter:"LINEAR",magFilter:"NEAREST"};var ne={renderQuad:{attribs:(Yr={},Yr.position={buffer:new Float32Array([-1,1,-1,-1,1,1,1,-1]),storeType:"STATIC"},Yr.uv={buffer:new Float32Array([0,1,0,0,1,1,1,0]),storeType:"STATIC"},Yr),drawType:"TRIANGLE_STRIP",itemCount:4}},ae={basicEffect:{vert:"\n\t\t\tattribute vec2 position;\n\t\t\tattribute vec2 uv;\n\t\t\tvarying vec2 coords;\n\t\t\tvoid main() {\n\t\t\t\tcoords = uv;\n\t\t\t\tgl_Position = vec4(position, 0.0, 1.0);\n\t\t\t}",frag:"precision mediump float;\n\t\t\tuniform sampler2D source;\n\t\t\tvarying vec2 coords;\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = texture2D(source, coords);\n\t\t\t}"}},ue=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t};function ie(t){var r=[{},{}],e=function(t){return{clearColor:[0,0,0,1],enable:[t.DEPTH_TEST],blendFunc:[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA]}}(t),n=Qr(t).update(ne.renderQuad),a=function(){return $r().update({form:n,shade:Zr(t).update(ae.basicEffect)})},u=a(),i=function(e,n){void 0===e&&(e=1),void 0===n&&(n=!1);var a=t.canvas;return(function(t,r){void 0===r&&(r=1),r=Math.max(1,r);var e=t.clientWidth*r|0,n=t.clientHeight*r|0;return(t.width!==e||t.height!==n)&&(t.width=e,t.height=n,!0)}(a,e)||n)&&r.forEach(function(r){r.width=a.width,r.height=a.height,r.textureConfig={count:1,type:t.UNSIGNED_BYTE},Wr(t,r,ee)}),o};i(1,!0);var o={gl:t,updateDrawSettings:function(r){return jr(t,ue({},e,r)),o},createForm:function(){return Qr(t)},createShade:function(){return Zr(t)},createSketch:function(){return $r()},createFlatSketch:a,createStaticLayer:function(){return function(t){var r={},e=t.createTexture();return r.textures=[e],r.data={},r.texture=function(){return e},r.update=function(n){return t.bindTexture(t.TEXTURE_2D,e),kr(t,n,r.data),n.asset&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n.asset),n.minFilter&&n.minFilter.indexOf("MIPMAP")>0&&t.generateMipmap(t.TEXTURE_2D),t.bindTexture(t.TEXTURE_2D,null),Object.assign(r.data,n),r},r.destroy=function(){t.deleteTexture(e)},r}(t)},createDrawingLayer:function(){return te(t)},createEffectLayer:function(){return te(t).update({sketches:[a()]})},draw:function(r,e){return oe(t,r,null,e),o},compose:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return function(t,r,e,n){for(var a=r.length-1,u=function(u){var i=r[u],o=function(r,a){var u=e[0],o=e[1],f=!a&&null==i.target;if(a?(t.bindFramebuffer(t.FRAMEBUFFER,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)):i.target?(t.bindFramebuffer(t.FRAMEBUFFER,i.target.frameBuffer),t.viewport(0,0,i.target.width,i.target.height)):(t.bindFramebuffer(t.FRAMEBUFFER,o.frameBuffer),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight)),i.data.drawSettings&&jr(t,i.data.drawSettings),i.sketches)for(var c=0,s=i.sketches;c<s.length;c++){var d=s[c];oe(t,d,u.textures[0],r)}else oe(t,n,null,{source:i.texture()});i.data.drawSettings&&Kr(t,i.data.drawSettings),f&&(e[0]=o,e[1]=u)};if(Array.isArray(i.uniforms))for(var f=a+i.uniforms.length-1,c=0;c<i.uniforms.length;c++){var s=u+c===f;o(i.uniforms[c],s)}else{var s=u===a;o(i.uniforms,s)}},i=0;i<r.length;i++)u(i)}(t,e,r,u),o},resize:i,destroy:function(){u.destroy();for(var e=0,n=r;e<n.length;e++){var a=n[e];qr(t,a)}}};return o}function oe(t,r,e,n){var a=r.shade,u=r.uniforms,i=r.form,o=r.drawSettings;if(!a||!i)throw Error("cannot draw, shader or geometry are not set");if(t.useProgram(a.program),function(t,r){for(var e in r.attribs){var n=t.attributeSetters[e];n&&n.setter(r.attribs[e])}}(a,i),n&&ce(a,n,e),o&&jr(t,o),Array.isArray(u))for(var f=0,c=u;f<c.length;f++){fe(t,r,e,c[f])}else fe(t,r,e,u);o&&Kr(t,o)}function fe(t,r,e,n){n&&ce(r.shade,n,e),r.form.elements&&null!=r.form.elements.glType?(t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.form.elements.buffer),t.drawElements(r.form.drawType,r.form.itemCount,r.form.elements.glType,0)):t.drawArrays(r.form.drawType,0,r.form.itemCount)}function ce(t,r,e){for(var n in r){var a=t.uniformSetters[n];if(a){var u=r[n];null===u||"string"==typeof u?a.setter(e):a.setter(u)}}}var se=function(t,r){return t!==r};function de(){return{canvas:Rr(null,function(t){var r=document.createElement("canvas");return document.body.appendChild(r),t(r),function(){document.body.removeChild(r)}})}}function le(t,r,e){var n=Sr([t.HOT],re),a=yr([n.HOT],function(t,r){var e=ie(r);return t(e),e.destroy}).accept(se),u=Sr([t.HOT,r.HOT],function(t){return{width:t.clientWidth,height:t.clientHeight}});return a.react([u.HOT],function(t,r){return t.resize()},"updateSize"),e&&a.react([e.HOT],function(t,r){return t.updateDrawSettings(r)}),{painter:a,gl:n,canvasSize:u}}function Te(t,r){var e=yr([t.HOT],function(t,r){var e=r.createShade();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}function Ee(t,r){var e=yr([t.HOT],function(t,r){var e=r.createForm();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}function _e(t,r){var e=yr([t.HOT],function(t,r){var e=r.createSketch();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}function Ae(t,r){var e=yr([t.HOT],function(t,r){var e=r.createFlatSketch();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}function he(t,r){var e=yr([t.HOT],function(t,r){var e=r.createStaticLayer();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}function pe(t,r){var e=yr([t.HOT],function(t,r){var e=r.createDrawingLayer();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}function Me(t,r){var e=yr([t.HOT],function(t,r){var e=r.createEffectLayer();return t(e),e.destroy});return r&&e.react([r.HOT],function(t,r){return t.update(r)}),e}e.d(r,"vr",function(){return me});var me={camera:u,flowCamera:i,flowPainterUtils:o};r.default={vr:me}}])});